### phase01 - cluster health
GET /_cluster/health?pretty

### phase01 - list candidate indices
GET /_cat/indices/paloalto-*,paloalto-linux-*,filebeat-*,logs-*?v&s=index&h=index,docs.count,store.size

### phase02 - gpsvc presence (sample)
GET paloalto-linux-messages-*/_search
{
  "size": 3,
  "track_total_hits": true,
  "_source": ["@timestamp","log.file.path","message","event.original"],
  "query": {
    "bool": {
      "should": [
        { "match_phrase": { "log.file.path": "gpsvc.log" } },
        { "query_string": { "default_field": "log.file.path", "query": "*gpsvc.log" } }
      ],
      "minimum_should_match": 1
    }
  },
  "sort": [{ "@timestamp": "asc" }]
}

### phase02 - gpsvc count
GET paloalto-linux-messages-*/_count
{
  "query": {
    "bool": {
      "should": [
        { "match_phrase": { "log.file.path": "gpsvc.log" } },
        { "query_string": { "default_field": "log.file.path", "query": "*gpsvc.log" } }
      ],
      "minimum_should_match": 1
    }
  }
}

### phase02 - unmarshal session errors (key IOC)
GET paloalto-linux-messages-*/_search
{
  "size": 20,
  "track_total_hits": true,
  "_source": ["@timestamp","log.file.path","message","event.original"],
  "query": {
    "query_string": {
      "query": "message:\"failed to unmarshal session\" OR event.original:\"failed to unmarshal session\""
    }
  },
  "sort": [{ "@timestamp": "asc" }]
}
